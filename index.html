<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: Arial, sans-serif;
            color: #fff;
        }
        #game-area {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        .amoeba {
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        .food {
            position: absolute;
            border-radius: 50%;
            background-color: #00ff00;
            box-shadow: 0 0 5px #00ff00;
        }
        .predator {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #ff0000;
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            animation: rotate 2s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        #reset-button, #score-display, #time-display {
            position: absolute;
            top: 10px;
            padding: 10px 20px;
            background-color: rgba(76, 175, 80, 0.7);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }
        #reset-button {
            right: 10px;
            cursor: pointer;
        }
        #reset-button:hover {
            background-color: rgba(69, 160, 73, 0.9);
        }
        #score-display {
            left: 10px;
        }
        #time-display {
            left: 50%;
            transform: translateX(-50%);
        }
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #ff0000;
            display: none;
        }
        .powerup {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #ff00ff;
            border-radius: 5px;
            animation: pulse 1s infinite alternate;
        }
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.2); }
        }
    </style>
</head>
<body>
    <div id="game-area"></div>
    <button id="reset-button">Reset Game</button>
    <div id="score-display">Score: 0</div>
    <div id="time-display">Time: 60</div>
    <div id="game-over">GAME OVER</div>
    <audio id="merge-sound" src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjU0AAAAAAAAAAAAAAAAJAYAAAAAAAAABYYPbGGhAAAA//tAwAAAB4QXj1BQAglxhCG/AAABMm93Z3Jdnf/Rgc6wKAhuF4KAgCAIA+D9YP//10HfWD/8H18H3/ghCAQBAEBg/8EAQB//BAEAQDBoGgaDf//+D74WOlTni1xOhJHRiIqTiZEYib//qpPnCWH9WpFgya1YxC1lpf/6kjZ0vUiotNKnHUymU7f/9avJpGIzkiUoaeo45J5UpS9v//sUj2Ik9Wq/W1p1esSfZUo6kyZIkn////2U6kYjMkydSSoiIzIzM//0RmSI//9ESZNlV6szjgiBER/zERERERERERERE=" preload="auto"></audio>
    <audio id="split-sound" src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjU0AAAAAAAAAAAAAAAAJAQAAAAAAAAABYZhvWitAAAA//tAwAAAB3QfjXBQAAxoCDHOgAABS4dydhSfQi4uqFD+IWQ0g4UgquCDgx//9cHIOD9YOCg/B+sFAgCAYKBgoEAx///nPqAYLB//BBgEAQDBQIBAfwQBwP//9YIHA4CAIAgCAIAgCAKA4DgIBr///wfAoEAQBAIAgCAQBA//84nWZt1fX+lsEiYCkqPb1YGjcTx8ek0/////jKLwTE4a9YjTE3u8amIXieMRBGI//6Ypj8D4uDp/xE4njYqGolwbGIiP///0xn4XBeEomjUjcVDEwfOgwVC8VDUzGZn///9o+FwRheGIhjeNheLgyMxkZmZyHqTKQv//9MZHQXBKGIWg6Ng6NxgwEoXBcZjMzM//1GdBwFoYheFoNjcOjQUC8WCoYHDMZmZ////3KZ2HImC8NQ9G4ehiLRsJwxFoaj9zM//90yHIcheFoUhOD41GIrGQpFoaj///zZ/Mj0Iw1C0JwfGoxFYyFItDUf///4yPZHsdhWFoUg+Mw5GImFYvEQ5H////yf9IziULQnB8ZhyMRMKxeIhyP///+0j+JZeEIWg6LRQJBCIhGIBCFIaj////vJnlkwcBwEQSBAGwOA0BwFAMAgCAN///5JQcAgCgIAgCAIAgCAMAgCAIA3///lAEAQBAEAQBAEAQBAEAQBAG////KAIAAAA=" preload="auto"></audio>
    <audio id="powerup-sound" src="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA//tQwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1//////////////////////////////////////////////////////////////////8AAAAATGF2YzU4LjU0AAAAAAAAAAAAAAAAJAQAAAAAAAAABYZhvWitAAAA//tAwAAAB3QfjXBQAAxoCDHOgAABS4dydhSfQi4uqFD+IWQ0g4UgquCDgx//9cHIOD9YOCg/B+sFAgCAYKBgoEAx///nPqAYLB//BBgEAQDBQIBAfwQBwP//9YIHA4CAIAgCAIAgCAKA4DgIBr///wfAoEAQBAIAgCAQBA//84nWZt1fX+lsEiYCkqPb1YGjcTx8ek0/////jKLwTE4a9YjTE3u8amIXieMRBGI//6Ypj8D4uDp/xE4njYqGolwbGIiP///0xn4XBeEomjUjcVDEwfOgwVC8VDUzGZn///9o+FwRheGIhjeNheLgyMxkZmZyHqTKQv//9MZHQXBKGIWg6Ng6NxgwEoXBcZjMzM//1GdBwFoYheFoNjcOjQUC8WCoYHDMZmZ////3KZ2HImC8NQ9G4ehiLRsJwxFoaj9zM//90yHIcheFoUhOD41GIrGQpFoaj///zZ/Mj0Iw1C0JwfGoxFYyFItDUf///4yPZHsdhWFoUg+Mw5GImFYvEQ5H////yf9IziULQnB8ZhyMRMKxeIhyP///+0j+JZeEIWg6LRQJBCIhGIBCFIaj////vJnlkwcBwEQSBAGwOA0BwFAMAgCAN///5JQcAgCgIAgCAIAgCAMAgCAIA3///lAEAQBAEAQBAEAQBAEAQBAG////KAIAAAA=" preload="auto"></audio>
    <script>
        const gameArea = document.getElementById('game-area');
        const mergeSound = document.getElementById('merge-sound');
        const splitSound = document.getElementById('split-sound');
        const powerupSound = document.getElementById('powerup-sound');
        const scoreDisplay = document.getElementById('score-display');
        const timeDisplay = document.getElementById('time-display');
        const gameOverDisplay = document.getElementById('game-over');
        const amoebas = [];
        const foodParticles = [];
        const predators = [];
        const powerups = [];
        let score = 0;
        let timeLeft = 60;
        let gameInterval;

        const evolutionStages = [
            { color: '#ff9999', size: 1.0 },
            { color: '#ff6666', size: 1.1 },
            { color: '#ff3333', size: 1.2 },
            { color: '#ff0000', size: 1.3 },
            { color: '#cc0000', size: 1.4 }
        ];

        function createAmoeba(x, y, size, speed = 1, stage = 0) {
            const amoeba = document.createElement('div');
            amoeba.className = 'amoeba';
            amoeba.style.left = `${x}px`;
            amoeba.style.top = `${y}px`;
            amoeba.style.width = `${size}px`;
            amoeba.style.height = `${size}px`;
            amoeba.style.backgroundColor = evolutionStages[stage].color;
            gameArea.appendChild(amoeba);

            const amoebaObj = {
                element: amoeba,
                x,
                y,
                size,
                vx: (Math.random() - 0.5) * 2 * speed,
                vy: (Math.random() - 0.5) * 2 * speed,
                speed: speed,
                stage: stage,
                collisions: 0,
                invincible: false
            };

            amoeba.addEventListener('mousedown', (e) => popAmoeba(amoebaObj));
            amoeba.addEventListener('touchstart', (e) => popAmoeba(amoebaObj));

            amoebas.push(amoebaObj);
            return amoebaObj;
        }

        function createFood() {
            const food = document.createElement('div');
            food.className = 'food';
            const size = 10;
            const x = Math.random() * (gameArea.clientWidth - size);
            const y = Math.random() * (gameArea.clientHeight - size);
            food.style.left = `${x}px`;
            food.style.top = `${y}px`;
            food.style.width = `${size}px`;
            food.style.height = `${size}px`;
            gameArea.appendChild(food);

            const foodObj = { element: food, x, y, size };
            foodParticles.push(foodObj);
        }

        function createPredator() {
            const predator = document.createElement('div');
            predator.className = 'predator';
            const size = 30;
            const x = Math.random() * (gameArea.clientWidth - size);
            const y = Math.random() * (gameArea.clientHeight - size);
            predator.style.left = `${x}px`;
            predator.style.top = `${y}px`;
            gameArea.appendChild(predator);

            const predatorObj = {
                element: predator,
                x,
                y,
                size,
                vx: (Math.random() - 0.5) * 4,
                vy: (Math.random() - 0.5) * 4
            };
            predators.push(predatorObj);
        }

        function createPowerup() {
            const powerup = document.createElement('div');
            powerup.className = 'powerup';
            const size = 20;
            const x = Math.random() * (gameArea.clientWidth - size);
            const y = Math.random() * (gameArea.clientHeight - size);
            powerup.style.left = `${x}px`;
            powerup.style.top = `${y}px`;
            gameArea.appendChild(powerup);

            const powerupObj = { element: powerup, x, y, size };
            powerups.push(powerupObj);
        }

        function updateAmoeba(amoeba) {
    amoeba.x += amoeba.vx;
    amoeba.y += amoeba.vy;

    if (amoeba.x < 0 || amoeba.x > gameArea.clientWidth - amoeba.size) {
        amoeba.vx *= -1;
    }
    if (amoeba.y < 0 || amoeba.y > gameArea.clientHeight - amoeba.size) {
        amoeba.vy *= -1;
    }

    amoeba.element.style.left = `${amoeba.x}px`;
    amoeba.element.style.top = `${amoeba.y}px`;
}

function updatePredator(predator) {
    predator.x += predator.vx;
    predator.y += predator.vy;

    if (predator.x < 0 || predator.x > gameArea.clientWidth - predator.size) {
        predator.vx *= -1;
    }
    if (predator.y < 0 || predator.y > gameArea.clientHeight - predator.size) {
        predator.vy *= -1;
    }

    predator.element.style.left = `${predator.x}px`;
    predator.element.style.top = `${predator.y}px`;
}

function checkCollisions() {
    for (let i = 0; i < amoebas.length; i++) {
        const amoeba = amoebas[i];
        
        // Check collisions with food
        for (let j = 0; j < foodParticles.length; j++) {
            const food = foodParticles[j];
            if (isColliding(amoeba, food)) {
                gameArea.removeChild(food.element);
                foodParticles.splice(j, 1);
                j--;
                amoeba.size += 5;
                amoeba.element.style.width = `${amoeba.size}px`;
                amoeba.element.style.height = `${amoeba.size}px`;
                score += 10;
                scoreDisplay.textContent = `Score: ${score}`;
                mergeSound.play();
            }
        }

        // Check collisions with predators
        for (let j = 0; j < predators.length; j++) {
            const predator = predators[j];
            if (isColliding(amoeba, predator) && !amoeba.invincible) {
                gameArea.removeChild(amoeba.element);
                amoebas.splice(i, 1);
                i--;
                score -= 20;
                scoreDisplay.textContent = `Score: ${score}`;
                break;
            }
        }

        // Check collisions with powerups
        for (let j = 0; j < powerups.length; j++) {
            const powerup = powerups[j];
            if (isColliding(amoeba, powerup)) {
                gameArea.removeChild(powerup.element);
                powerups.splice(j, 1);
                j--;
                applyPowerup(amoeba);
                powerupSound.play();
            }
        }
    }
}

function isColliding(obj1, obj2) {
    return (
        obj1.x < obj2.x + obj2.size &&
        obj1.x + obj1.size > obj2.x &&
        obj1.y < obj2.y + obj2.size &&
        obj1.y + obj1.size > obj2.y
    );
}

function applyPowerup(amoeba) {
    const powerupType = Math.floor(Math.random() * 3);
    switch (powerupType) {
        case 0: // Speed boost
            amoeba.speed *= 1.5;
            amoeba.vx *= 1.5;
            amoeba.vy *= 1.5;
            setTimeout(() => {
                amoeba.speed /= 1.5;
                amoeba.vx /= 1.5;
                amoeba.vy /= 1.5;
            }, 5000);
            break;
        case 1: // Size increase
            amoeba.size *= 1.5;
            amoeba.element.style.width = `${amoeba.size}px`;
            amoeba.element.style.height = `${amoeba.size}px`;
            setTimeout(() => {
                amoeba.size /= 1.5;
                amoeba.element.style.width = `${amoeba.size}px`;
                amoeba.element.style.height = `${amoeba.size}px`;
            }, 5000);
            break;
        case 2: // Temporary invincibility
            amoeba.invincible = true;
            amoeba.element.style.border = '2px solid white';
            setTimeout(() => {
                amoeba.invincible = false;
                amoeba.element.style.border = 'none';
            }, 5000);
            break;
    }
}

function popAmoeba(amoeba) {
    if (amoeba.size > 30) {
        const newSize = amoeba.size / 2;
        const newAmoeba = createAmoeba(amoeba.x + newSize, amoeba.y + newSize, newSize, amoeba.speed, amoeba.stage);
        amoeba.size = newSize;
        amoeba.element.style.width = `${newSize}px`;
        amoeba.element.style.height = `${newSize}px`;
        splitSound.play();
    }
}

function evolveAmoeba(amoeba) {
    amoeba.collisions++;
    if (amoeba.collisions >= 5 && amoeba.stage < evolutionStages.length - 1) {
        amoeba.stage++;
        amoeba.collisions = 0;
        amoeba.element.style.backgroundColor = evolutionStages[amoeba.stage].color;
        amoeba.size *= evolutionStages[amoeba.stage].size;
        amoeba.element.style.width = `${amoeba.size}px`;
        amoeba.element.style.height = `${amoeba.size}px`;
    }
}

function gameLoop() {
    amoebas.forEach(updateAmoeba);
    predators.forEach(updatePredator);
    checkCollisions();

    if (Math.random() < 0.02) createFood();
    if (Math.random() < 0.005) createPredator();
    if (Math.random() < 0.002) createPowerup();

    timeLeft--;
    timeDisplay.textContent = `Time: ${timeLeft}`;

    if (timeLeft <= 0 || amoebas.length === 0) {
        endGame();
    }
}

function startGame() {
    createAmoeba(gameArea.clientWidth / 2, gameArea.clientHeight / 2, 20);
    gameInterval = setInterval(gameLoop, 1000 / 60);
}

function endGame() {
    clearInterval(gameInterval);
    gameOverDisplay.style.display = 'block';
}

function resetGame() {
    clearInterval(gameInterval);
    gameOverDisplay.style.display = 'none';
    amoebas.forEach(amoeba => gameArea.removeChild(amoeba.element));
    foodParticles.forEach(food => gameArea.removeChild(food.element));
    predators.forEach(predator => gameArea.removeChild(predator.element));
    powerups.forEach(powerup => gameArea.removeChild(powerup.element));
    amoebas.length = 0;
    foodParticles.length = 0;
    predators.length = 0;
    powerups.length = 0;
    score = 0;
    timeLeft = 60;
    scoreDisplay.textContent = 'Score: 0';
    timeDisplay.textContent = 'Time: 60';
    startGame();
}

document.getElementById('reset-button').addEventListener('click', resetGame);

startGame();
